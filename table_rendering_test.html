<!DOCTYPE html>
<html>
<head>
    <title>Table Rendering Test</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            font-size: 11px;
            background: white;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 6px 8px;
            text-align: left;
        }
        
        /* Day row styles - blue background */
        .day-row {
            background: linear-gradient(135deg, #007bff, #0056b3) !important;
            color: white !important;
            font-weight: bold !important;
            font-size: 14px !important;
            text-transform: uppercase !important;
            letter-spacing: 1px !important;
        }
        
        /* Meal row styles - green background */
        .meal-row {
            background: linear-gradient(135deg, #28a745, #20c997) !important;
            color: white !important;
            font-weight: bold !important;
            font-size: 12px !important;
        }
        
        /* Normal food rows */
        .food-row {
            background: white;
        }
        
        .food-row:hover {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <h1>Table Rendering Test - Day and Meal Lines</h1>
    <p>This test shows how the day and meal lines would appear in the actual table after the fixes.</p>
    
    <table>
        <thead>
            <tr style="background: linear-gradient(135deg, #007bff, #0056b3); color: white;">
                <th>Yemek Adƒ±</th>
                <th>Kalori</th>
                <th>Karb</th>
                <th>Protein</th>
                <th>Yaƒü</th>
                <th>ƒ∞≈ülemler</th>
            </tr>
        </thead>
        <tbody id="testTableBody">
        </tbody>
    </table>
    
    <script>
        // Simulate the formatted data that would come from the fixed extraction
        const testData = [
            { text: "Test Hasta", type: "info" },
            { text: "üìÖ PAZARTESƒ∞", type: "day" },
            { text: "üçΩÔ∏è √ñƒüle (tercihen saat 12:00 civarƒ±nda)", type: "meal" },
            { text: "tavuk pirzola 150gr", type: "food" },
            { text: "salata", type: "food" },
            { text: "üçΩÔ∏è Ak≈üam (tercihen hava kararƒ±nca)", type: "meal" },
            { text: "et yemeƒüi", type: "food" },
            { text: "üìÖ SALI", type: "day" },
            { text: "üçΩÔ∏è Sabah (tercihen saat 07:00 civarƒ±nda)", type: "meal" },
            { text: "kahvaltƒ±", type: "food" },
            { text: "üçΩÔ∏è √ñƒüle (tercihen saat 12:00 civarƒ±nda)", type: "meal" },
            { text: "balƒ±k", type: "food" },
            { text: "üìÖ √áAR≈ûAMBA", type: "day" },
            { text: "üçΩÔ∏è √ñƒüle (tercihen saat 12:00 civarƒ±nda)", type: "meal" },
            { text: "150 gr avokado", type: "food" },
            { text: "üçΩÔ∏è Ak≈üam (tercihen hava kararƒ±nca)", type: "meal" },
            { text: "normal yemek satƒ±rƒ±", type: "food" }
        ];
        
        // Render the table
        const tbody = document.getElementById('testTableBody');
        testData.forEach((item, index) => {
            const row = document.createElement('tr');
            
            if (item.type === 'day') {
                row.className = 'day-row';
                row.innerHTML = `
                    <td colspan="6" style="padding: 8px; text-align: left; font-weight: bold; font-size: 14px;">
                        ${item.text}
                    </td>
                `;
            } else if (item.type === 'meal') {
                row.className = 'meal-row';
                row.innerHTML = `
                    <td colspan="6" style="padding: 6px; text-align: left; font-weight: bold; font-size: 12px;">
                        ${item.text}
                    </td>
                `;
            } else if (item.type === 'info') {
                row.innerHTML = `
                    <td colspan="6" style="padding: 15px; text-align: center; background: white; border: 2px solid #007bff; font-weight: bold; color: #007bff;">
                        üìã ${item.text.toUpperCase()}
                    </td>
                `;
            } else {
                row.className = 'food-row';
                const isMatched = Math.random() > 0.5; // Simulate some matched foods
                const icon = isMatched ? '‚úÖ' : '‚ùå';
                const color = isMatched ? '#28a745' : '#dc3545';
                
                row.innerHTML = `
                    <td style="padding: 4px 6px;">
                        <span style="color: ${color}; margin-right: 6px; font-size: 14px;">${icon}</span>
                        ${item.text}
                    </td>
                    <td style="padding: 4px; text-align: center;">${isMatched ? Math.floor(Math.random() * 200) + 50 : '-'}</td>
                    <td style="padding: 4px; text-align: center;">${isMatched ? (Math.random() * 30).toFixed(1) : '-'}</td>
                    <td style="padding: 4px; text-align: center;">${isMatched ? (Math.random() * 25).toFixed(1) : '-'}</td>
                    <td style="padding: 4px; text-align: center;">${isMatched ? (Math.random() * 15).toFixed(1) : '-'}</td>
                    <td style="padding: 4px; text-align: center;">
                        <button style="background: #ffc107; color: #212529; border: none; padding: 2px 4px; border-radius: 3px; font-size: 9px; margin-right: 2px; cursor: pointer;">‚úèÔ∏è</button>
                        <button style="background: #dc3545; color: white; border: none; padding: 2px 4px; border-radius: 3px; font-size: 9px; cursor: pointer;">üóëÔ∏è</button>
                    </td>
                `;
            }
            
            tbody.appendChild(row);
        });
        
        console.log('‚úÖ Test table rendered successfully');
        console.log('üìä Day rows:', document.querySelectorAll('.day-row').length);
        console.log('üçΩÔ∏è Meal rows:', document.querySelectorAll('.meal-row').length);
        console.log('üçé Food rows:', document.querySelectorAll('.food-row').length);
    </script>
    
    <div style="margin-top: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; background: #f8f9fa;">
        <h3>‚úÖ Issues Fixed:</h3>
        <ul>
            <li><strong>Day lines:</strong> Now appear with blue background and proper formatting (üìÖ PAZARTESƒ∞, üìÖ SALI, etc.)</li>
            <li><strong>Meal lines:</strong> Now appear with green background and proper formatting (üçΩÔ∏è √ñƒüle, üçΩÔ∏è Ak≈üam, etc.)</li>
            <li><strong>Monday first lunch line:</strong> Will now be properly detected and displayed</li>
            <li><strong>Pattern detection:</strong> Enhanced to handle various text encodings and formats</li>
        </ul>
        
        <h3>üîß Changes Made:</h3>
        <ul>
            <li>Updated <code>gunOgunMu</code> detection in <code>updateYemekVeritabaniAnalizi</code> function</li>
            <li>Added emoji formatting logic in <code>extractTariflerDetay</code> function</li>
            <li>Enhanced pattern matching for better character encoding support</li>
            <li>Added support for standalone meal names (√∂ƒüle, ak≈üam, sabah)</li>
        </ul>
    </div>
</body>
</html>